{{- if .Values.secrets.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
type: Opaque
data:
  # Values are base64 encoded by Helm
  DATABASE_URL: {{ .Values.secrets.DATABASE_URL | required "secrets.DATABASE_URL is required when secrets.create=true" | b64enc | quote }}
  GEMINI_API_KEY: {{ .Values.secrets.GEMINI_API_KEY | required "secrets.GEMINI_API_KEY is required when secrets.create=true" | b64enc | quote }}
  BETTER_AUTH_SECRET: {{ .Values.secrets.BETTER_AUTH_SECRET | required "secrets.BETTER_AUTH_SECRET is required when secrets.create=true" | b64enc | quote }}
{{- end }}
{{- /*
  NOTE: When secrets.create=false (default), create secrets manually:

  kubectl create secret generic todo-secrets \
    --from-literal=DATABASE_URL='your-database-url' \
    --from-literal=GEMINI_API_KEY='your-api-key' \
    --from-literal=BETTER_AUTH_SECRET='your-secret'
*/ -}}
